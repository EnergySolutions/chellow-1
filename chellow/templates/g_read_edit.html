{% extends "base.html" %}

{% block inner_header %}
	<style>
		label {
			width: 11em;
			float: left;
		}
	</style>
{% endblock %}

{% block title %}
	Gas Contracts &gt; {{g_read.g_bill.g_batch.g_contract.name}} &gt; Batches &gt;
	{{g_read.g_bill.g_batch.reference}} &gt; Bills &gt; {{read.bill.id}} &gt;
 	Read {{g_read.id}} Edit
{% endblock %}

{% block nav %}
	<a href="{{context_path}}/g_contracts">Gas Contracts</a> &gt;
	<a
			href="{{context_path}}/g_contracts/{{g_read.g_bill.g_batch.g_contract.id}}"
			>{{g_read.g_bill.g_batch.g_contract.name}}</a> &gt;
	<a
			href="{{context_path}}/g_batches?g_contract_id={{g_read.g_bill.g_batch.g_contract.id}}"
			>Batches</a> &gt;
	<a
	 		href="{{context_path}}/g_batches/{{g_read.g_bill.g_batch.id}}"
			>{{g_read.g_bill.g_batch.reference}}</a> &gt;
	<a
	 		href="{{context_path}}/g_bills/{{g_read.g_bill.id}}"
			>Bill {{g_read.g_bill.id}}</a> &gt;
 	Read {{g_read.id}} Edit
{% endblock %}

{% block content %}
	{% if request.values.confirm_delete %}
		<form method="post" action=".">
			<fieldset>
				<legend>
					Are you sure you want to delete this register read?
				</legend>
				<input type="submit" name="delete" value="Delete">
			</fieldset>
		</form>
		<p><a href=".">Cancel</a></p>
	{% else %}
		<form action="." method="post">
			<fieldset>
				<legend>Update this read</legend>
				<br>
				<label>MPAN</label> {{input_text('mpan', read.mpan_str)}}
				<br>
				<label>Coefficient</label>
					{{input_text('coefficient', read.coefficient)}}
				<br>
				<label>Meter Serial Number</label>
					{{input_text('msn', read.msn)}}
				<br>
				<label>Units</label>
					{{input_text('units', read.units_as_str())}}
				<br>
				<label>TPR</label>
					<select name="tpr_id">
						{% for tpr in tprs %}
							{{input_option('tpr_id', tpr.id, tpr.code, read.tpr.id)}}
						{% endfor %}
					</select>
				<br>
				<br>
				<fieldset>
					<legend>Previous Read</legend>
					<fieldset>
						<legend>Date</legend>
						{{input_date('previous', read.previous_date)}}
					</fieldset>
					<br>
					<label>Value</label>
						{{input_text('previous_value', read.previous_value)}}
					<br>
					<label>Type</label>
						<select name="previous_type_id">
							{% for read_type in read_types %}
								{{
									input_option(
										'previous_type_id', read_type.id,
										read_type.code + ' ' + read_type.description,
										read.previous_type.id)}}
							{% endfor %}
						</select>
				</fieldset>
				<br>
				<br>
				<fieldset>
					<legend>Present Read</legend>
					<fieldset>
						<legend>Date</legend>
						{{input_date('present', read.present_date)}}
					</fieldset>
					<br>
					<label>Value</label>
						{{input_text('present_value', read.present_value)}}
					<br>
					<label>Type</label>
					<select name="present_type_id">
						{% for read_type in read_types %}
							{{
								input_option(
									'present_type_id', read_type.id,
									read_type.code + ' ' + read_type.description,
									read.present_type.id)}}
						{% endfor %}
					</select>
				</fieldset>
				<br>
				<br>
				<input type="submit" name="update" value="Update">
			</fieldset>
		</form>
		<br>
		<form action=".">
			<fieldset>
				<legend>Delete this read</legend>
				<input name="confirm_delete" type="submit" value="Delete">
			</fieldset>
		</form>
	{% endif %}
{% endblock %}
