{% extends "base.html" %}

{% block title %}
	Gas Contracts &gt; {{g_bill.g_batch.g_contract.name}} &gt; Batches &gt;
 	{{g_bill.g_batch.reference}} &gt; {{g_bill.reference}}
{% endblock %}

{% block nav %}
	<a href="{{context_path}}/g_contracts">Gas Contracts</a> &gt;
	<a
			href="{{context_path}}/g_contracts/{{g_bill.g_batch.g_contract.id}}"
			>{{g_bill.g_batch.g_contract.name}}</a> &gt;
	<a
	 		href="{{context_path}}/g_batches?g_contract_id={{g_bill.g_batch.g_contract.id}}"
			>Batches</a> &gt;
	<a
	 		href="{{context_path}}/g_batches/{{g_bill.g_batch.id}}"
			>{{g_bill.g_batch.reference}}</a> &gt; Bill {{g_bill.id}}
	[<a href="{{context_path}}/g_bills/{{g_bill.id}}/edit">edit</a>]
{% endblock %}

{% block content %}
	<table><caption>Bill</caption>
		<thead>
			<tr>
				<th>Supply</th>
				<th>Reference</th>
				<th>Account</th>
				<th>Issue Date</th>
				<th>From</th>
				<th>To</th>
				<th>kWh</th>
				<th>Net GBP</th>
				<th>VAT GBP</th>
				<th>Gross GBP</th>
				<th>Type</th>
				<th>Check</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>
					<a
					 		href="{{context_path}}/g_supplies/{{g_bill.g_supply.id}}"
							>Supply</a>
				</td>
				<td>{{g_bill.reference}}</td>
				<td>{{g_bill.account}}</td>
				<td>{{g_bill.issue_date|hh_format}}</td>
				<td>{{g_bill.start_date|hh_format}}</td>
				<td>{{g_bill.finish_date|hh_format}}</td>
				<td>{{g_bill.kwh}}</td>
				<td>{{g_bill.net_gbp}}</td>
				<td>{{g_bill.vat_gbp}}</td>
				<td>{{g_bill.gross_gbp}}</td>
				<td>
					<a
					 	href="{{context_path}}/bill_types/{{g_bill.bill_type.id}}"
					 	title="{{g_bill.bill_type.description}}"
						>{{g_bill.bill_type.code}}</a>
				</td>
				<td>
					<a
					 		href="{{context_path}}/reports/429?g_bill_id={{g_bill.id}}"
							>Check</a>
				</td>
			</tr>
		</tbody>
	</table>
	

	<br>
	<br>
	<table>
		<caption>
			Reads
			[<a
			 		href="{{context_path}}/g_bills/{{g_bill.id}}/add_read">add</a>]
		</caption>
		<thead>
			<tr>
				<th rowspan="2">Edit</th>
				<th rowspan="2">MSN</th>
				<th colspan="3">Previous</th>
				<th colspan="3">Present</th>
				<th rowspan="2">Units</th>
				<th rowspan="2">Correction Factor</th>
			</th>
			</tr>
			<tr>
				<th>Date</th>
				<th>Value</th>
				<th>Type</th>
				<th>Date</th>
				<th>Value</th>
				<th>Type</th>
			</tr>
		</thead>
		<tbody>
			{% for g_read in g_reads %}
				<tr>
					<td>
						[<a href="{{context_path}}/g_reads/{{g_read.id}}/edit">edit</a>]
					</td>
					<td>{{g_read.msn}}</td>
					<td>{{g_read.prev_date|hh_format}}</td>
					<td>{{g_read.prev_value}}
					<td>
						<a
				 				title="{{g_read.prev_type.description}}"
								href="{{context_path}}/g_read_types/{{g_read.prev_type.id}}"
								>{{g_read.prev_type.code}}</a>
					</td>
					<td>{{g_read.pres_date|hh_format}}</td>
					<td>{{g_read.pres_value}}</td>
					<td>
						<a
								title="{{g_read.pres_type.description}}"
								href="{{context_path}}/g_read_types/{{g_read.pres_type.id}}"
								>{{g_read.pres_type.code}}</a>
					</td>
					<td>{{g_read.units}}</td>
					<td>{{g_read.correction_factor}}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>

	<h3>Raw Bill</h3>

	<pre>{{g_bill.raw_lines}}</pre>
	<br>

	<table>
		<caption>Breakdown</caption>
		<thead>
			<tr>
				<th>element</th>
				{% for col in column_list %}
					<th>{{col}}</th>
				{% endfor %}
			</tr>  
		</thead>
		<tbody>
			{% for row in row_list %}
				<tr>
					<td>{{row}}</td>
					{% for col in column_list %}
						<td>{{grid[row][col]}}</td>
					{% endfor %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
{% endblock %}
