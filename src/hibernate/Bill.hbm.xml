<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
      "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
	<!--

		Copyright 2005, 2011 Wessex Water Limited This file is part of
		Chellow. Chellow is free software; you can redistribute it and/or
		modify it under the terms of the GNU General Public License as
		published by the Free Software Foundation; either version 2 of the
		License, or (at your option) any later version. Chellow is distributed
		in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
		even the implied warranty of MERCHANTABILITY or FITNESS FOR A
		PARTICULAR PURPOSE. See the GNU General Public License for more
		details. You should have received a copy of the GNU General Public
		License along with Chellow; if not, write to the Free Software
		Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301
		USA
	-->

<hibernate-mapping package="net.sf.chellow.billing">
	<class name="Bill" table="bill" lazy="true">
		<id name="id">
			<generator class="sequence">
				<param name="sequence">bill_id_sequence</param>
			</generator>
		</id>
		<many-to-one name="batch" class="Batch" column="batch_id"
			foreign-key="fkey_bill_batch" />
		<many-to-one name="supply" class="net.sf.chellow.physical.Supply"
			column="supply_id" foreign-key="fkey_bill_supply" />
		<property name="issueDate" type="timestamp" not-null="true"
			index="issue_date_idx">
			<column name="issue_date" sql-type="timestamp with time zone" />
		</property>
		<component name="startDate" class="net.sf.chellow.physical.HhStartDate">
			<property type="timestamp" name="date" index="start_date_idx">
				<column name="start_date" sql-type="timestamp with time zone" />
			</property>
		</component>
		<component name="finishDate" class="net.sf.chellow.physical.HhStartDate">
			<property type="timestamp" name="date" index="finish_date_idx">
				<column name="finish_date" sql-type="timestamp with time zone" />
			</property>
		</component>
		<property name="net" type="big_decimal" not-null="true">
			<column name="net" sql-type="numeric" />
		</property>
		<property name="vat" type="big_decimal" not-null="true">
			<column name="vat" sql-type="numeric" />
		</property>
		<property name="gross" type="big_decimal" not-null="true">
			<column name="gross" sql-type="numeric" />
		</property>
		<many-to-one name="type" class="BillType" column="bill_type_id"
			foreign-key="fkey_bill__bill_type" />
		<property name="kwh" type="big_decimal">
			<column name="kwh" sql-type="numeric" />
		</property>
		<property type="string" name="reference" column="reference"
			not-null="true" />
		<property type="string" name="account" column="account"
			not-null="true" />
		<property type="string" name="breakdown" column="breakdown"
			not-null="true" />
		<set name="reads" inverse="true" lazy="true" cascade="all,delete-orphan">
			<key column="bill_id" on-delete="cascade"/>
			<one-to-many class="net.sf.chellow.physical.RegisterRead" />
		</set>
	</class>
</hibernate-mapping>

