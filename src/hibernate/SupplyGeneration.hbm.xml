<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
      "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
	<!--

		Copyright 2005-2008 Meniscus Systems Ltd This file is part of Chellow.

		Chellow is free software; you can redistribute it and/or modify it
		under the terms of the GNU General Public License as published by the
		Free Software Foundation; either version 2 of the License, or (at your
		option) any later version. Chellow is distributed in the hope that it
		will be useful, but WITHOUT ANY WARRANTY; without even the implied
		warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See
		the GNU General Public License for more details. You should have
		received a copy of the GNU General Public License along with Chellow;
		if not, write to the Free Software Foundation, Inc., 51 Franklin St,
		Fifth Floor, Boston, MA 02110-1301 USA
	-->

<hibernate-mapping package="net.sf.chellow.physical">
	<class name="SupplyGeneration" table="supply_generation">
		<id name="id">
			<generator class="sequence">
				<param name="sequence">
					supply_generation_id_sequence
				</param>
			</generator>
		</id>
		<many-to-one name="supply" class="Supply" column="supply_id"
			not-null="true" foreign-key="fkey_supply_generation_supply" />
		<many-to-one name="gspGroup" class="GspGroup" column="gsp_group_id"
			foreign-key="fkey_supply_generation__gsp_group" />
		<many-to-one name="meter" class="Meter" column="meter_id"
			foreign-key="fkey_supply_generation_meter" />
		<set name="siteSupplyGenerations" inverse="true" cascade="all,delete-orphan"
			order-by="site_id">
			<key column="supply_generation_id" />
			<one-to-many class="SiteSupplyGeneration" />
		</set>
		<many-to-one name="mopAccount" class="net.sf.chellow.billing.Account"
			column="mop_account_id" foreign-key="fkey_mpan_mop_account" />
		<many-to-one name="hhdcAccount" class="net.sf.chellow.billing.Account"
			column="hhdc_account_id" foreign-key="fkey_mpan_hhdc_account" />
		<many-to-one name="importMpan" class="Mpan" column="import_mpan_id"
			foreign-key="fkey_supply_generation_import_mpan" />
		<many-to-one name="exportMpan" class="Mpan" column="export_mpan_id"
			foreign-key="fkey_supply_generation_export_mpan" />
		<component name="startDate" class="HhEndDate">
			<property type="timestamp" name="date">
				<column name="start_date" sql-type="timestamp with time zone" />
			</property>
		</component>
		<component name="finishDate" class="HhEndDate">
			<property type="timestamp" name="date">
				<column name="finish_date" sql-type="timestamp with time zone" />
			</property>
		</component>
		<set name="mpans" inverse="true" lazy="true" cascade="all,delete-orphan">
			<key column="supply_generation_id" />
			<one-to-many class="Mpan" />
		</set>
		<set name="channels" inverse="true" cascade="all,delete-orphan"
			order-by="is_import desc, is_kwh desc">
			<key column="supply_generation_id" />
			<one-to-many class="Channel" />
		</set>
	</class>
</hibernate-mapping>

