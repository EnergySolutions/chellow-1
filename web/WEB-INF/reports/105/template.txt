<!doctype html>
<html>
  <head>
    <link rel="stylesheet" type="text/css"
      href="{{context_path}}/reports/19/output/">
    <title>
      Chellow &gt; Supplier Contracts &gt; {{bill.batch.contract.name}} &gt;
      Batches &gt; {{bill.batch.reference}} &gt; {{bill.reference}}
    </title>
    </head>
  <body>
    <p>
      <a href="{{context_path}}/reports/1/output/">Chellow</a> &gt;
      <a href="{{context_path}}/reports/75/output/">Supplier Contracts</a> &gt;
      <a href="{{context_path}}/reports/77/output/?supplier_contract_id={{bill.batch.contract.id}}">{{bill.batch.contract.name}}</a> &gt;
      <a href="{{context_path}}/reports/89/output/?supplier-contract-id={{bill.batch.contract.id}}">Batches</a> &gt;
      <a href="{{context_path}}/reports/91/output/?batch-id={{bill.batch.id}}">
      {{bill.batch.reference}}</a> &gt;
      Bill {{bill.id}}
      [<a href="{{context_path}}/reports/165/output/?supplier_bill_id={{bill.id}}">edit</a>]
    </p>
   {% if messages %}
      <ul>
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    <br>
    <table><caption>Bill</caption>
      <thead>
        <tr>
          <th>Supply</th>
          <th>Reference</th>
          <th>Account</th>
          <th>Issue Date</th>
          <th>From</th>
          <th>To</th>
          <th>kWh</th>
          <th>Net</th>
          <th>VAT</th>
          <th>Gross</th>
          <th>Type</th>
          <th>Check</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <a href="{{context_path}}/reports/7/output/?supply_id={{bill.supply.id}}">Supply</a>
          </td>
          <td>{{bill.reference}}</td>
          <td>{{bill.account}}</td>
          <td>{{bill.issue_date.strftime('%Y-%m-%d %H:%M')}}</td>
          <td>{{bill.start_date|hh_format }}</td>
          <td>{{bill.finish_date|hh_format }}</td>
          <td>{{bill.kwh}}</td>
          <td>{{bill.net}}</td>
          <td>{{bill.vat}}</td>
          <td>{{bill.gross}}</td>
          <td>
            <a href="{{context_path}}/reports/201/output/?bill_type_id={{bill.bill_type.id}}" title="{{bill.bill_type.description}}">{{bill.bill_type.code}}</a>
          </td>
          <td>
            <a href="{{context_path}}/reports/111/output/?bill_id={{bill.id}}">Check</a>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <br>
    <table>
      <caption>
        Reads
        [<a href="{{context_path}}/reports/189/output/?supplier_bill_id={{bill.id}}">add</a>]
      </caption>
      <thead>
        <tr>
          <th rowspan="2">Edit</th>
          <th rowspan="2">MPAN</th>
          <th rowspan="2">Coefficient</th>
          <th rowspan="2">Units</th>
          <th rowspan="2">TPR</th>
          <th rowspan="2">Meter Serial Number</th>
          <th colspan="3">Previous</th>
          <th colspan="3">Present</th>
        </tr>
        <tr>
          <th>Date</th>
          <th>Value</th>
          <th>Type</th>
          <th>Date</th>
          <th>Value</th>
          <th>Type</th>
        </tr>
      </thead>
      <tbody>
        {% for read in register_reads %}
          <tr>
            <td>
              [<a href="{{context_path}}/reports/31/output/?supplier_read_id={{read.id}}">edit</a>]
            </td>
            <td>{{read.mpan_str}}</td>
            <td>{{read.coefficient}}</td>
            <td>{{read.units_as_str()}}</td>
            <td>
              <a href="{{context_path}}/reports/97/output/?tpr_id={{read.tpr.id}}">{{read.tpr.code}}</a>
            </td>
            <td>{{read.msn}}</td>
            <td>{{read.previous_date|hh_format}}</td>
            <td>{{read.previous_value}}</td>
            <td>
              <a title="{{read.previous_type.description}}"
              href="{{context_path}}/reports/143/output/?type-id={{read.previous_type.id}}">{{read.previous_type.code}}</a>
            </td>
            <td>{{read.present_date|hh_format}}</td>
            <td>{{read.present_value}}</td>
            <td>
              <a title="{{read.present_type.description}}"
              href="{{context_path}}/reports/143/output/?type-id={{read.present_type.id}}">{{read.present_type.code}}</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <h3>Breakdown</h3>

    <pre>
      {%- for line in raw_lines -%}
        {{line}}<br>
      {%- endfor -%}
    </pre>
    <br>

    <table>
      <thead>
        <tr>
          <th>element</th>
          {% for col in column_list %}
            <th>{{col}}</th>
          {% endfor %}
        </tr>  
      </thead>
      <tbody>
        {% for row in row_list %}
          <tr>
            <td>{{row}}</td>
            {% for col in column_list %}
              <td>{{grid[row][col]}}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </body>
</html>